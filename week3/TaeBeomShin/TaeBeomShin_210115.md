<h1>스프링 부트와 JPA 활용1 - 2일차(도메인 분석 설계) </h1>

- 스프링 부트 기본원리, 기초 강좌에서 했던 내용에서 많이 DB개념과, 기능의 복잡성이 올라감.
- 다대일, 일대다, 다대다 등 다양한 관계형 데이터베이스 형태를 학습할 수 있는 예제.
- 백엔드 개발자로 일하기 위해 sql문 작성과 DB design 등에 대한 이해가 필요해 보인다.

## 다대다 매핑
: 학교 Database 시간에도 교수님이 최대한 N-N 매핑을 피하려고 말씀하셨었는데 강사님도 유사한 말씀을 하심.
  Item - Category의 매핑 관계에서 N:N 매핑으로 생각하였으나, 이들 사이에 새로운 entity를 추가하여 1:N N:1 
  매핑으로 변경한 점이 인상 깊었음.

## 연관관계 매핑

* 일대다, 다대일 관계의 매핑

- 일대다, 다대일 관계의 매핑에 있는 경우, Jpa가 처리할 수 있도록 주인 역할을 할 엔티티를 설정해줘야한다.
  이경우에, 외래 키가 있는 엔티티를 주인으로 설정하는 것이 좋다.
  ex) 회원과 주문: 외래키가 있는 주문을 주인 엔티티로 설정(Member_ID)기 외래키로 매핑 됨.

- 비즈니스 상의 우선순위는 연관관계에서 주인 엔티티를 설정하는 이유와 무관하다. 외래키가 있는 엔티티를 주인으로
  설정하는 이유는, 외래키가 없는 엔티티를 주인으로 설정할 경우 외래키에 대한 관리와 유지 보수가 어렵고, 쿼리의
  성능 문제이슈가 있기 때문이라고 한다.(JPA에서 이 내용에 대해 다룬다고 한다.)

## 엔티티 설계시 주의점

1. 엔티티에는 Setter 사용을 최소화 해야한다.

- Setter가 모두 open되어 있을 경우, 유지보수가 어렵기때문(보안 이슈도 있음.)

2. 모든 연관관계는 "지연로딩"으로 설정해야한다.

- 즉시로딩(EAGER)은 예측과 추적이 어렵고, Jpql 실행시 N+1 문제가 발생할 수 있음.
- 그러므로 실무에서 LAZY로딩으로 설정해야 한다.
- @XTOTONE 관계는 기본이 즉시로딩이므로, 직접 지연로딩으로 설정해야 한다.

3. 컬렉선은 필드에서 바로 초기화 하자

- 외부에서 건들지 말고, 필드에서 바로 초기화 함으로써 문제 발생요소를 사전에 차단한다.

4. 테이블 칼럼명 생성 전략

- SpringPhysicalNamingStrategy 에서 설정을 변경할 수 있음.
- 기본 설정은 카멜 케이스 -> 언더스코어로 바꾸는 형식이다. ex) memberPoint -> member_point