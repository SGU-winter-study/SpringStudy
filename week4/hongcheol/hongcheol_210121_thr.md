# JPA 소개
## SQL 중심적인 개발의 문제점
관계형 DB가 알아들을 수 있는 SQL을 계속해서 날려줘야한다.

CRUD 와 같은 SQL 코드를 무한히 반복해야한다.

객체와 관계형 데이터베이스의 패러다임이 다르다.
애초에 관계형 디비는 데이터를 정규화해서 보관하는게 목표고 객체는 속성과 기능을 잘 캡슐화해서 쓰는게 목표인데, 안맞는 곳에 안맞는 것을 넣으려니까 문제가 발생한다.

### 객체와 관계형 데이터베이스의 차이
상속
 객체 상속 관계 -> Table 슈퍼타입 서브타입 관계

어찌어찌해서 잘 저장을 했는데, 조회하려면 각각의 테이블에 따른 JOIN SQL … 각각의 객체 생성.. 너무 복잡하다. 그래서 DB에 저장할 때 객체에는 상속 관계를 안쓴다.

객체는 참조를 사용하고, 테이블은 외래키를 사용한다.
객체에서는 외래키에 해당하는 애를 참조로 연관관계를 맺는다.

이 경우 자바 컬랙션에 저장하는 경우에는 좋다.

하지만 조회할 때, SQL해서 JOIN을 한 다음. 데이터베이스에서 가져오고 하는 등의 반복작업들이 필요하다.

어떻게 쿼리를 조립하고했는지를 확인하지않으면 엔티티를 신뢰할 수 없어진다.

그렇다고 모든 데이터를 다 가져와서 가지고 있기도 어렵다.

즉, 계층 분할이 어렵다. 그 이유는 객체의 특징을 이용해서 모델링할수록 매핑 작업만 늘어나기 때문이다.

이런 고민들을 해결하기 위해서 자바 진영에서는 JPA를 사용한다.

JPA를 이용하면 컬랙션에 저장하듯 DB에 저장할 수 있다.

JPA는 애플리케이션과 JDBC 사이에서 동작한다. 개발자가 JPA를 이용해서 개발을 하면 JPA는 JDBC API를 이용해서 DB에 넣어준다.

JPA에게 멤버 객체를 넘겨주면, JPA가 객체를 분석하고 쿼리를 생성한 다음에, JDBC API를 이용해서 DB에 넣어준다. 이때, 패러다임 불일치를 해결해준다.

## JPA를 사용해야하는 이유
-SQL 중심적인 개발에서 객체 중심으로 개발 
-생산성
코드가 다 만들어져있어서 불러서 쓰면된다.
-유지보수
JPA는 필드만 추가해주면, SQL 쪽에대해서는 알아서 처리해주기 때문에 유지보수에 용이하다.

-패러다임의 불일치 해결 
알아서 다 처리해주기 때문에, 동일한 트랜잭션에서 조회한 엔티티는 같은 엔티티임을 보장해준다. 그 이유는 자바 컬렉션에 저장했다 빼는 것과 같이 작동하기 때문이다.


-성능
같은 트랜잭션 안에서는 같은 엔티티를 반환해서 약간의 조회 성능을 향상시킬 수 있다. 캐싱을 하고있어서 결과적으로 같은 PK에대해서 같은 값을 조회하면 같은 결과를 반환해서 SQL을 한 번만 실행한다. 그래서 Repeatable Read를 보장한다.

트랜잭션을 커밋하기 전까지 INSERT SQL을 모아놨다가 JDBC BATCH SQL 기능을 사용해서 한 번에 전송한다. 
또한, 객체가 실제 사용될 때 로딩하는 지연로딩과 JOIN SQL로 한번에 연관된 객체까지 미리 조회하는 즉시 로딩을 옵션 하나로 바꿀 수 있어진다. (fetch = FetchType.LAZY)이런 식으로 가능하다.

-데이터 접근 추상화와 벤더 독립성 
-표준이다. 

